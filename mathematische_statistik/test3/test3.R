# ================================================================
data <- c(2 ,5 ,0 ,2 ,2, 2, 0 ,6 ,0 ,5, 2, 0, 10, 2, 2, 6, 3, 3, 7, 4)

# Эмпирическая функция распределения
ecdf_func <- ecdf(data)

print(ecdf_func(5.3))

# ================================================================
# Про то сколько раз встретился элемент в выборке исходя из объёма выборки и
# графика эмпирической функции распределения
n <- 50
Fn_v_tochke <- 0.7-0.54 # не забудем вычесть если дальше идём по иксам
print(n * Fn_v_tochke)



# ================================================================
# Дана выборка из БИНОМИНАЛЬНОГО распределения B_n,0.3, где параметер n неизвестен:
B_p = 0.3
data <- c(4,0,1,2,0,0,1,2,4,3)

b_mean <- mean(data)
print(b_mean)
# Вычисляем смещенную выборочную дисперсию
biased_variance <- var(data) * (length(data) - 1)/(length(data))
print(biased_variance)

# Оценка параметра n методом моментов по
# 1) средневыброчному и 2) смещённой выборочной дисперсии

n_paramether <- b_mean / B_p
print(n_paramether)

n_paramether <- biased_variance / (B_p*(1-B_p))
print(n_paramether)

# ================================================================
# Про хи-квадрат и РАВНОМЕРНОЕ распределение 
# Наблюдаемые данные
observed <- c(20, 13, 20, 16, 10, 21)
print(observed)
# Ожидаемые данные (равномерное распределение)
expected <- rep(sum(observed) / length(observed), length(observed))

# Выполнение теста хи-квадрат
result <- chisq.test(observed, p = expected / sum(expected))

# Вывод результатов
print(result) # Потом сравниваем с таблицей Хи^2 


# ================================================================
# Однородность двух распределений Хи-квадрат
data1 <- c(7,23,17,8)
data2 <- c(16,14,5,5)
data <- matrix(c(data1,data2), ncol=2)
print(data)

# Выполнение теста хи-квадрат
result <- chisq.test(data, correct=FALSE)

# Вывод результатов
print(result) # Потом сравниваем с таблицей Хи^2 | Если выч. больше то отвергаем


# ================================================================
# Гипотеза независимости Хи-квадрат
data <- matrix(c(330, 615, 59, 256), ncol=2)
print(data)

# Выполнение теста хи-квадрат
result <- chisq.test(data, correct=FALSE) # correct = FALSE !!!!!!

# Вывод результатов
print(result) # Потом сравниваем с таблицей Хи^2 | Если выч. больше то отвергаем

# ================================================================
# Линейная регрессия.
X <- c(2,3,4,5,6)
Y <- c(5.1,3.4,3.2,2.7,2.55)
model <- lm(Y ~ X)

print(summary(model)) # Ето не всё

# Получение предсказанных значений
Y_pred <- predict(model)

# Вычисление общей суммы квадратов (TSS)
TSS <- sum((Y - mean(Y))^2)

# Вычисление суммы квадратов регрессии (RSS)
RSS <- sum((Y_pred - mean(Y))^2)

# Вычисление суммы квадратов остатков (ESS)
ESS <- sum((Y - Y_pred)^2)

# Вывод результатов
cat("Общая сумма квадратов (TSS):", TSS, "\n")
cat("Сумма квадратов регрессии (RSS):", RSS, "\n")
cat("Сумма квадратов остатков (ESS):", ESS, "\n")

# Проверка связи между суммами квадратов
print("Проверь на калькуляторе: TSS = RSS + ESS")




