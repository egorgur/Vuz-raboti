# ================================================================
data <- c(2,1,6,0,8,2,4,2,1,8,0,0,0,2,1,5,1,2,1,0)

# Эмпирическая функция распределения
ecdf_func <- ecdf(data)

print(ecdf_func(3))

# ================================================================
# Про то сколько раз встретился элемент в выборке исходя из объёма выборки и
# графика эмпирической функции распределения
n <- 40
Fn_v_tochke <- 0.7 # не забудем вычесть если дальше идём по иксам
print(n * Fn_v_tochke)



# ================================================================
# Дана выборка из БИНОМИНАЛЬНОГО распределения B_n,0.3, где параметер n неизвестен:
# B_p = 0.3
data <- c(-1, 0, 3, 1, 0, -1, -2, -2, 2, -3)

b_mean <- mean(data)
print(b_mean)
# Вычисляем смещенную выборочную дисперсию
biased_variance <- var(data) * (length(data) - 1)/(length(data))
print(biased_variance)

# Оценка параметра n методом моментов по
# 1) средневыброчному и 2) смещённой выборочной дисперсии

n_paramether <- b_mean / B_p
print(n_paramether)

n_paramether <- biased_variance / (B_p*(1-B_p))
print(n_paramether)

# ================================================================
# Про хи-квадрат и РАВНОМЕРНОЕ распределение 
# Наблюдаемые данные
observed <- c(9,15,46,46,24,8)
print(observed)
# Ожидаемые данные (равномерное распределение)
expected <- rep(sum(observed) / length(observed), length(observed))

# Выполнение теста хи-квадрат
result <- chisq.test(observed, p = expected / sum(expected), correct=FALSE)

# Вывод результатов
print(result) # Потом сравниваем с таблицей Хи^2 


# ================================================================
# Однородность двух распределений Хи-квадрат
data1 <- c(60,15,9,6)
data2 <- c(40.609,22.285,12.23,6.714)
data <- matrix(c(data1,data2), ncol=2)
print(data)

# Выполнение теста хи-квадрат
result <- chisq.test(data, correct=FALSE)

# Вывод результатов
print(result) # Потом сравниваем с таблицей Хи^2 | Если выч. больше то отвергаем


# ================================================================
# Гипотеза независимости Хи-квадрат
data <- matrix(c(2721, 129, 345, 138), ncol=2)
print(data)

# Выполнение теста хи-квадрат
result <- chisq.test(data, correct=FALSE) # correct = FALSE !!!!!!

# Вывод результатов
print(result) # Потом сравниваем с таблицей Хи^2 | Если выч. больше то отвергаем

# ================================================================
# Линейная регрессия.
X <- c(2,3,4,5,6)
Y <- c(1.9,5.5,10,15,21)
model <- lm(Y ~ X)

print(summary(model)) # Ето не всё

# Получение предсказанных значений
Y_pred <- predict(model)

# Вычисление общей суммы квадратов (TSS)
TSS <- sum((Y - mean(Y))^2)

# Вычисление суммы квадратов регрессии (RSS)
RSS <- sum((Y_pred - mean(Y))^2)

# Вычисление суммы квадратов остатков (ESS)
ESS <- sum((Y - Y_pred)^2)

# Вывод результатов
cat("Общая сумма квадратов (TSS):", TSS, "\n")
cat("Сумма квадратов регрессии (RSS):", RSS, "\n")
cat("Сумма квадратов остатков (ESS):", ESS, "\n")

# Проверка связи между суммами квадратов
print("Проверь на калькуляторе: TSS = RSS + ESS")




