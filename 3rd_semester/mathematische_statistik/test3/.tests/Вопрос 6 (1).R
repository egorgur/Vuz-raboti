# Уровень значимости (например, 0.05) #МЕНЯЕМ ЗНАЧЕНИЕ!!!
alpha <- 0.05

group1 <- c(7,16,11,6)  # Наблюдения в первой группе # МЕНЯЕМ ЗНАЧЕНИЕ!!!
group2 <- c(5,9,24,12)  # Наблюдения во второй группе # МЕНЯЕМ ЗНАЧЕНИЕ

#ДОБАВЛЯЕТ ДОПОЛНИТЕЛЬНЫЕ ГРУППЫ, ЕСЛИ ИХ БОЛЬШЕ 2!!!

# Объединяем данные в таблицу наблюдений
observed <- rbind(group1, group2) #МЕНЯЕМ, ЕСЛИ БОЛЬШЕ ГРУПП!!!






#=======================================================================================

# Добавляем названия строк и столбцов (опционально, для удобства)
#rownames(observed) <- c("Group 1", "Group 2")
#colnames(observed) <- c("Category 1", "Category 2", "Category 3", "Category 4")

# Вывод таблицы наблюдений
cat("Таблица наблюдений:\n")
print(observed)

# Выполняем тест хи-квадрат
test_result <- chisq.test(observed)

# Получаем значения из теста
chi_square_statistic <- test_result$statistic  # Наблюдаемое значение хи-квадрат
degrees_of_freedom <- test_result$parameter    # Число степеней свободы

# Рассчитываем критическое значение хи-квадрат
critical_value <- qchisq(1 - alpha, df = degrees_of_freedom)

# Вывод результатов
cat("\nРезультаты теста хи-квадрат:\n")
cat("Наблюдаемое значение хи-квадрат:", chi_square_statistic, "\n")
cat("Степени свободы:", degrees_of_freedom, "\n")
cat("Критическое значение (при уровне значимости 0.05):", critical_value, "\n")

# Проверка гипотезы
if (chi_square_statistic > critical_value) {
  cat("\nГипотеза об однородности отвергается (наблюдаемое значение больше критического).\n")
} else {
  cat("\nНет оснований отвергнуть гипотезу об однородности (наблюдаемое значение меньше или равно критическому).\n")
}

