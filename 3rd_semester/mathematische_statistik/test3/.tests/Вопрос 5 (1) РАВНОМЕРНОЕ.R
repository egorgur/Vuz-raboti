#ДАННЫЙ КОД РАССЧИТАН ДЛЯ РАВНОМЕРНОГО РАСПРЕДЕЛЕНИЯ

# Входные данные
observed <- c(9,15,46,46,24,8)  # Наблюдаемые частоты МЕНЯЕМ ЗНАЧЕНИЕ!!!
intervals <- list(c(2, 3), c(3, 4), c(4, 5), c(5, 6), c(6, 7), c(7, 8))  # Интервалы МЕНЯЕЙ ЗНАЧЕНИЕ!!!
a <- 2  # Начало распределения МЕНЯЕМ ЗНАЧЕНИЕ!!!
b <- 8   # Конец распределения МЕНЯЕМ ЗНАЧЕНИЕ!!!
alpha <- 0.1  # Уровень значимости МЕНЯЕМ ЗНАЧЕНИЕ!!!



#===========================================================================================




# Шаг 1: Общее число наблюдений
n_total <- sum(observed)

# Шаг 2: Расчёт плотности вероятности для равномерного распределения
P <- dunif(observed, min = a, max = b)  # Плотность равна 1 / (b - a)
print(P)

# Шаг 3: Расчёт ожидаемых частот
expected <- rep(P * n_total, length(intervals))  # Ожидаемые частоты одинаковы

# Вывод ожидаемых частот для проверки
cat("Ожидаемые частоты:\n")
print(expected)

# Шаг 4: Вычисление выборочного значения статистики критерия хи-квадрат
chi_square <- sum((observed - expected)^2 / expected)

# Шаг 5: Критическое значение хи-квадрат
df <- length(intervals) - 1  # Степени свободы: k - 1
critical_value <- qchisq(1 - alpha, df)

# Шаг 6: Проверка гипотезы
if (chi_square < critical_value) {
  result <- "Гипотеза о равномерном распределении принимается"
} else {
  result <- "Гипотеза о равномерном распределении отвергается"
}

# Вывод результатов
cat("Выборочное значение статистики критерия:", round(chi_square, 2), "\n")
cat("Критическое значение статистики критерия:", round(critical_value, 2), "\n")
cat("Результат:", result, "\n")
