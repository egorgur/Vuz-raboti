# Критическое значение F_кр для alpha = 0.01
alpha <- 0.05 #МЕНЯЕМ ЗНАЧЕНИЕ!!!
x <- c(2, 3, 4, 5 , 6) #МЕНЯЕМ ЗНАЧЕНИЕ!!!
y <- c(1.9,5.5,10,15,21) #МЕНЯЕМ ЗНАЧЕНИЕ!!!






#========================================================================================





# Шаг 1: Вычисление среднего значения
x_mean <- mean(x)
y_mean <- mean(y)

# Шаг 2: Вычисление коэффициентов линейной регрессии
b1 <- sum((x - x_mean) * (y - y_mean)) / sum((x - x_mean)^2)
b0 <- y_mean - b1 * x_mean

# Уравнение регрессии
regression_eq <- paste0("y = ", b1, " * x + ", b0)

# Шаг 3: Расчёт прогнозных значений y~
y_pred <- b0 + b1 * x

# Вычисление отклонений
residuals <- y - y_pred
explained_dev <- y_pred - y_mean

# Шаг 4: Вычисление Q1 и Q2
Q1 <- sum(explained_dev^2)
Q2 <- sum(residuals^2)

# Шаг 5: Вычисление статистики F
n <- length(x)  # Объём выборки
F <- Q1 / (Q2 / (n - 2))

k1 <- 1  # Число степеней свободы числителя
k2 <- n - 2  # Число степеней свободы знаменателя
F_crit <- qf(1 - alpha, df1 = k1, df2 = k2)

# Вывод результатов
cat("Среднее значение x̄:", x_mean, "\n")
cat("Среднее значение ȳ:", y_mean, "\n")
cat("Коэффициенты регрессии: b1 =", b1, ", b0 =", b0, "\n")
cat("Уравнение регрессии:", regression_eq, "\n")
cat("Сумма квадратов отклонений, объясняемых моделью (Q1):", Q1, "\n")
cat("Сумма квадратов отклонений ошибки (Q2):", Q2, "\n")
cat("Статистика F:", F, "\n")
cat("Критическое значение F_кр:", F_crit, "\n")

# Проверка гипотезы
if (F > F_crit) {
  cat("Нулевая гипотеза отвергается (регрессия статистически значима, F > F_кр)\n")
} else {
  cat("Нулевая гипотеза не отвергается (регрессия статистически не значима, F <= F_кр)\n")
}

