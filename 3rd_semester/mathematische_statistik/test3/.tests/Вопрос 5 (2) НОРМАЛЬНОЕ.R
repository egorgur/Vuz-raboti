#КОД РАССЧИТАН ДЛЯ НОРМАЛЬНОГО РАСПРЕДЕЛЕНИЯ!!!

# Данные
observed <- c(16, 33, 23, 18)  # Наблюдаемые частоты МЕНЯЕМ ЗНАЧЕНИЕ!!!
intervals <- c(-3, -2, -1, 0, 1)  # Границы интервалов МЕНЯЕМ ЗНАЧЕНИЕ!!!
mu <- -0.7  # Матожидание МЕНЯЕМ ЗНАЧЕНИЕ!!!
sigma <- 1  # Стандартное отклонение МЕНЯЕМ ЗНАЧЕНИЕ!!!
alpha <- 0.01  # Уровень значимости МЕНЯЕМ ЗНАЧЕНИЕ!!!


#=======================================================================================





n <- sum(observed)  # Общее число наблюдений

# Вычисление теоретических вероятностей для каждого интервала
theoretical_probs <- pnorm(intervals[-1], mean = mu, sd = sigma) - 
  pnorm(intervals[-length(intervals)], mean = mu, sd = sigma)

# Вычисление теоретических частот
expected <- n * theoretical_probs

# Подсчет критерия хи-квадрат
chi_sq <- sum((observed - expected)^2 / expected)

# Критическое значение хи-квадрат
critical_value <- qchisq(1 - alpha, df = length(observed) - 1)

# Вывод результатов
cat("Результаты проверки гипотезы:\n")
cat("Наблюдаемые частоты:      ", observed, "\n")
cat("Теоретические частоты:    ", round(expected, 3), "\n")
cat("Критерий хи-квадрат:      ", round(chi_sq, 3), "\n")
cat("Критическое значение:     ", round(critical_value, 3), "\n")

if (chi_sq > critical_value) {
  cat("Вывод: Гипотеза отвергается (данные не подчиняются нормальному распределению).\n")
} else {
  cat("Вывод: Гипотеза не отвергается (данные могут подчиняться нормальному распределению).\n")
}
